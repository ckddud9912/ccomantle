<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê¼¬ë§¨í‹€ ê²Œì„</title>

<style>
body { background:#f5f5f5; font-family:Arial; display:flex; justify-content:center; }

.container {
    width:900px; background:white; margin-top:40px; padding:30px;
    border-radius:12px; box-shadow:0 4px 20px rgba(0,0,0,0.05);
}

.inputbox {
    width:100%; padding:14px; font-size:17px;
    border-radius:10px; border:1px solid #ccc; margin-bottom:20px;
}

table { width:100%; margin-top:10px; border-collapse:collapse; text-align:center; }
th, td { padding:10px; border-bottom:1px solid #ddd; font-size:14px; }

th { background:#f0f0f0; }

.progress {
    width:150px; height:12px; background:#ddd; border-radius:6px; overflow:hidden;
}
.progress_inner {
    height:100%; background:#4b9cfc;
}

.hintbox {
    background:#eef6ff;
    padding:15px;
    border-radius:10px;
    margin-bottom:25px;
    line-height:1.5;
}
.hint_title { font-weight:bold; margin-bottom:6px; }
</style>

</head>
<body>

<div class="container">
    <h2 id="team_label"></h2>

    <!-- ìœ ì‚¬ë„ ì•ˆë‚´ ë¬¸êµ¬ -->
    <div class="hintbox">
        <div class="hint_title">ğŸ“˜ ìœ ì‚¬ë„ ì•ˆë‚´</div>
        ì •ë‹µ ë‹¨ì–´ì™€ ê°€ì¥ ìœ ì‚¬í•œ ë‹¨ì–´ì˜ ìœ ì‚¬ë„ëŠ” <b>ì˜ë¯¸ì ìœ¼ë¡œ ì–¼ë§ˆë‚˜ ê°€ê¹Œìš´ì§€</b>ë¥¼ ë‚˜íƒ€ë‚´ë©°  
        ì ìˆ˜ëŠ” <b>0ì—ì„œ 100ê¹Œì§€</b>ì…ë‹ˆë‹¤.  
        ì ìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ ì •ë‹µê³¼ ë” ë¹„ìŠ·í•œ ì˜ë¯¸ë¥¼ ê°€ì§„ ë‹¨ì–´ì…ë‹ˆë‹¤.
        <br><br>
        ìƒìœ„ê¶Œ ìœ ì‚¬ë„ ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
        <br>
        - TOP 1 ìœ ì‚¬ë„: ì˜ˆì‹œ 72.63  
        - TOP 10 ìœ ì‚¬ë„: ì˜ˆì‹œ 57.65  
        - TOP 1000 ìœ ì‚¬ë„: ì˜ˆì‹œ 26.69  
    </div>

    <input id="guess" class="inputbox" placeholder="ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ê³  Enterë¥¼ ëˆ„ë¥´ì„¸ìš”">

    <h3>ğŸ“Š ë¦¬ë”ë³´ë“œ (ìœ ì‚¬ë„ ë†’ì€ ìˆœ)</h3>

    <table>
        <thead>
            <tr>
                <th>íŒ€</th>
                <th>ë‹¨ì–´</th>
                <th>ìœ ì‚¬ë„</th>
                <th>ê°•ë„</th>
            </tr>
        </thead>
        <tbody id="leaderBody"></tbody>
    </table>

    <br><br>

    <!-- ìœ ì‚¬ë„ ì„¤ëª… ì„¹ì…˜ -->
    <h3>â“ ìœ ì‚¬ë„ëŠ” ë¬´ì—‡ì¸ê°€ìš”?</h3>
    <div class="hintbox">
        <ul style="padding-left:20px; line-height:1.7;">
            <li>ê¼¬ë§¨í‹€ì—ì„œ ìœ ì‚¬ë„ëŠ” ì¶”ì¸¡í•œ ë‹¨ì–´ì™€ ì •ë‹µ ë‹¨ì–´ê°€ <b>ì˜ë¯¸ì ìœ¼ë¡œ ì–¼ë§ˆë‚˜ ë¹„ìŠ·í•œì§€</b>ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œì…ë‹ˆë‹¤.</li>
            <li>ì ìˆ˜ëŠ” <b>0ì ì—ì„œ 100ì </b> ì‚¬ì´ì´ë©°, ì ìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ ë‘ ë‹¨ì–´ê°€ ì˜ë¯¸ì ìœ¼ë¡œ ë” ìœ ì‚¬í•©ë‹ˆë‹¤.</li>
            <li>ë³¸ ê²Œì„ì—ì„œëŠ” <b>í•œêµ­ì–´ SBERT(Sentence-BERT)</b> ì„ë² ë”© ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ë‘ ë‹¨ì–´ì˜ ë²¡í„° ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</li>
            <li>ë¦¬ë”ë³´ë“œì—ëŠ” ìƒìœ„ ìœ ì‚¬ë„ ë‹¨ì–´ë“¤ì´ ì‹¤ì‹œê°„ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</li>
        </ul>
    </div>

</div>

<script>
const teamName = localStorage.getItem("team_name") || "ë¯¸ë“±ë¡ íŒ€";
document.getElementById("team_label").innerText = "íŒ€: " + teamName;

const input = document.getElementById("guess");
const leaderBody = document.getElementById("leaderBody");

// ë‹¨ì–´ ì œì¶œ
input.addEventListener("keydown", async (e) => {
    if (e.key === "Enter") {
        const word = input.value.trim();
        if (!word) return;

        const r = await fetch(`/guess?word=${encodeURIComponent(word)}&team=${encodeURIComponent(teamName)}`);
        const data = await r.json();

        if (!data.ok) {
            alert(data.error);
            return;
        }
        input.value = "";
    }
});

// ë¦¬ë”ë³´ë“œ ìë™ ê°±ì‹ 
async function updateLeaderboard() {
    const r = await fetch("/leaderboard");
    const data = await r.json();

    if (!data.ok) return;

    leaderBody.innerHTML = "";

    data.leaderboard.forEach(row => {
        const tr = document.createElement("tr");

        const barPercent = Math.max(0, Math.min(100, row.similarity)); // 0~100

        tr.innerHTML = `
            <td>${row.team}</td>
            <td>${row.word}</td>
            <td>${row.similarity}</td>
            <td>
                <div class="progress">
                    <div class="progress_inner" style="width:${barPercent}%"></div>
                </div>
            </td>
        `;

        leaderBody.appendChild(tr);
    });
}

setInterval(updateLeaderboard, 1000);
</script>

</body>
</html>
