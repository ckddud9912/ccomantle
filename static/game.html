<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>게임</title>
</head>
<body>
    <h1>게임 화면</h1>

    <input id="team" placeholder="팀 이름 입력">
    <input id="word" placeholder="단어 입력">
    <button onclick="sendGuess()">제출</button>

    <p id="result"></p>

    <h3>Leaderboard</h3>
    <div id="lb"></div>

<script>
async function sendGuess() {
    const team = document.getElementById("team").value;
    const word = document.getElementById("word").value;

    let r = await fetch(`/guess?word=${word}&team=${team}`);
    let j = await r.json();

    document.getElementById("result").innerHTML =
        `${j.team} / ${j.word} → 점수 ${j.score}, 순위 ${j.rank}`;

    updateLB();
}

async function updateLB() {
    let r = await fetch("/leaderboard");
    let j = await r.json();

    let html = `
        최고 점수: ${j.best ?? '-'}<br>
        10위 점수: ${j.tenth ?? '-'}<br>
        1000위 점수: ${j.thousandth ?? '-'}<br><br>
    `;

    j.leaderboard.forEach((e, i) => {
        html += `${i+1}. [${e.team}] ${e.word} → ${e.score}<br>`;
    });

    document.getElementById("lb").innerHTML = html;
}

setInterval(updateLB, 2000);
</script>

</body>
</html>
