<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê¼¬ë§¨í‹€ ê²Œì„</title>

<style>
body { background:#f5f5f5; font-family:Arial; display:flex; justify-content:center; }

.container {
    width:900px; background:white; margin-top:40px; padding:30px;
    border-radius:12px; box-shadow:0 4px 20px rgba(0,0,0,0.05);
}

.inputbox {
    width:100%; padding:14px; font-size:17px;
    border-radius:10px; border:1px solid #ccc; margin-bottom:20px;
}

table { width:100%; margin-top:10px; border-collapse:collapse; }
th, td { padding:10px; border-bottom:1px solid #ddd; font-size:14px; }
th { background:#f0f0f0; }

.progress {
    width:150px; height:12px; background:#ddd; border-radius:6px; overflow:hidden;
}
.progress_inner {
    height:100%; background:#4b9cfc;
}
</style>

</head>
<body>

<div class="container">
    <h2 id="team_label"></h2>

    <input id="guess" class="inputbox" placeholder="ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ê³  Enterë¥¼ ëˆ„ë¥´ì„¸ìš”">

    <h3>ğŸ“Š ë¦¬ë”ë³´ë“œ (ìœ ì‚¬ë„ ë†’ì€ ìˆœ)</h3>

    <table>
        <thead>
            <tr>
                <th>íŒ€</th>
                <th>ë‹¨ì–´</th>
                <th>ìœ ì‚¬ë„</th>
                <th>ê°•ë„</th>
            </tr>
        </thead>
        <tbody id="leaderBody"></tbody>
    </table>
</div>

<script>
const teamName = localStorage.getItem("team_name") || "ë¯¸ë“±ë¡ íŒ€";
document.getElementById("team_label").innerText = "íŒ€: " + teamName;

const input = document.getElementById("guess");
const leaderBody = document.getElementById("leaderBody");

// ë‹¨ì–´ ì œì¶œ
input.addEventListener("keydown", async (e) => {
    if (e.key === "Enter") {
        const word = input.value.trim();
        if (!word) return;

        const r = await fetch(`/guess?word=${encodeURIComponent(word)}&team=${encodeURIComponent(teamName)}`);
        const data = await r.json();

        if (!data.ok) {
            alert(data.error);
            return;
        }
        input.value = "";
    }
});

// ë¦¬ë”ë³´ë“œ ìë™ ê°±ì‹ 
async function updateLeaderboard() {
    const r = await fetch("/leaderboard");
    const data = await r.json();

    if (!data.ok) return;

    leaderBody.innerHTML = "";

    data.leaderboard.forEach(row => {
        const tr = document.createElement("tr");

        const barPercent = Math.max(0, Math.min(100, row.similarity)); // 0~100

        tr.innerHTML = `
            <td>${row.team}</td>
            <td>${row.word}</td>
            <td>${row.similarity}</td>
            <td>
                <div class="progress">
                    <div class="progress_inner" style="width:${barPercent}%"></div>
                </div>
            </td>
        `;

        leaderBody.appendChild(tr);
    });
}

setInterval(updateLeaderboard, 1000);
</script>

</body>
</html>
